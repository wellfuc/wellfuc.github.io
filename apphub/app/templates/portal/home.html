{% extends "_layout.html" %}
{% block content %}
  <div class="header">
    <div>
      <h1>Welcome, {{ user.display_name or user.email }}</h1>
      <p class="muted">Discover internal tools, launch web apps, and download the latest desktop builds.</p>
    </div>
    <a class="button" href="{{ request.scope.root_path }}/apps">Browse apps</a>
  </div>

  {% if announcements %}
  <div class="card notice">
    <h3>Announcements</h3>
    {% for announcement in announcements %}
      <div class="announcement">
        <strong>{{ announcement.title }}</strong>
        <p>{{ announcement.body }}</p>
      </div>
    {% endfor %}
  </div>
  {% endif %}

  <div class="card" style="margin-bottom: 24px;">
    <h3>Featured apps</h3>
    <div class="grid cols-3" style="margin-top: 12px;">
      {% for app in featured_apps %}
        <a class="card" href="{{ request.scope.root_path }}/apps/{{ app.slug }}">
          <h3>{{ app.name }}</h3>
          <p class="muted">{{ app.description }}</p>
          {% if app.latest_release %}<p class="muted">Updated {{ app.latest_release.strftime('%Y-%m-%d') }}</p>{% endif %}
        </a>
      {% else %}
        <div class="card">No featured apps yet.</div>
      {% endfor %}
    </div>
  </div>

  <div class="card">
    <h3>Recently updated</h3>
    <div class="grid cols-3" style="margin-top: 12px;">
      {% for app in recent_apps %}
        <a class="card" href="{{ request.scope.root_path }}/apps/{{ app.slug }}">
          <h3>{{ app.name }}</h3>
          <p class="muted">{{ app.description }}</p>
          {% if app.latest_release %}<p class="muted">Updated {{ app.latest_release.strftime('%Y-%m-%d') }}</p>{% endif %}
        </a>
      {% else %}
        <div class="card">No recent updates yet.</div>
      {% endfor %}
    </div>
  </div>

  <div class="card" style="margin-top: 24px;">
    <h3>Browse by category</h3>
    <div class="grid cols-3" style="margin-top: 12px;">
      {% for category in categories %}
        <a class="card" href="{{ request.scope.root_path }}/categories/{{ category.slug }}">{{ category.name }}</a>
      {% endfor %}
    </div>
  </div>
{% endblock %}
